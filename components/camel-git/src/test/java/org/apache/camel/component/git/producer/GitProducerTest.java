begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * Licensed to the Apache Software Foundation (ASF) under one or more  * contributor license agreements.  See the NOTICE file distributed with  * this work for additional information regarding copyright ownership.  * The ASF licenses this file to You under the Apache License, Version 2.0  * (the "License"); you may not use this file except in compliance with  * the License.  You may obtain a copy of the License at  *  *      http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  * See the License for the specific language governing permissions and  * limitations under the License.  */
end_comment

begin_package
DECL|package|org.apache.camel.component.git.producer
package|package
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|component
operator|.
name|git
operator|.
name|producer
package|;
end_package

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|File
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashMap
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Map
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Properties
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Set
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|CamelExecutionException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|Exchange
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|Processor
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|builder
operator|.
name|RouteBuilder
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|component
operator|.
name|git
operator|.
name|GitConstants
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|component
operator|.
name|git
operator|.
name|GitTestSupport
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|api
operator|.
name|CreateBranchCommand
operator|.
name|SetupUpstreamMode
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|api
operator|.
name|Git
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|api
operator|.
name|MergeResult
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|api
operator|.
name|PullResult
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|api
operator|.
name|RemoteAddCommand
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|api
operator|.
name|Status
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|lib
operator|.
name|Ref
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|lib
operator|.
name|Repository
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|revwalk
operator|.
name|RevCommit
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|transport
operator|.
name|RemoteConfig
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|jgit
operator|.
name|transport
operator|.
name|URIish
import|;
end_import

begin_import
import|import
name|org
operator|.
name|junit
operator|.
name|Test
import|;
end_import

begin_class
DECL|class|GitProducerTest
specifier|public
class|class
name|GitProducerTest
extends|extends
name|GitTestSupport
block|{
annotation|@
name|Test
DECL|method|cloneTest ()
specifier|public
name|void
name|cloneTest
parameter_list|()
throws|throws
name|Exception
block|{
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:clone"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|initTest ()
specifier|public
name|void
name|initTest
parameter_list|()
throws|throws
name|Exception
block|{
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:init"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|checkoutTest ()
specifier|public
name|void
name|checkoutTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git checkout
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:checkout"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
comment|// Check
name|List
argument_list|<
name|Ref
argument_list|>
name|ref
init|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|boolean
name|branchCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/heads/"
operator|+
name|branchTest
argument_list|)
condition|)
block|{
name|branchCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|branchCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|checkoutSpecificTagTest ()
specifier|public
name|void
name|checkoutSpecificTagTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git create tag
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:create-tag"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
comment|// Check
name|List
argument_list|<
name|Ref
argument_list|>
name|ref
init|=
name|git
operator|.
name|tagList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|boolean
name|tagCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/tags/"
operator|+
name|tagTest
argument_list|)
condition|)
block|{
name|tagCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|tagCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
comment|// Test camel-git create-branch
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:checkout-specific-tag"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
comment|// Check
name|ref
operator|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
expr_stmt|;
name|boolean
name|branchCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/heads/"
operator|+
name|branchTest
argument_list|)
condition|)
block|{
name|branchCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|branchCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
argument_list|(
name|expected
operator|=
name|CamelExecutionException
operator|.
name|class
argument_list|)
DECL|method|doubleCloneOperationTest ()
specifier|public
name|void
name|doubleCloneOperationTest
parameter_list|()
throws|throws
name|Exception
block|{
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:clone"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:clone"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|pullTest ()
specifier|public
name|void
name|pullTest
parameter_list|()
throws|throws
name|Exception
block|{
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:clone"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|PullResult
name|pr
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:pull"
argument_list|,
literal|""
argument_list|,
name|PullResult
operator|.
name|class
argument_list|)
decl_stmt|;
name|assertTrue
argument_list|(
name|pr
operator|.
name|isSuccessful
argument_list|()
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|addTest ()
specifier|public
name|void
name|addTest
parameter_list|()
throws|throws
name|Exception
block|{
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
comment|// Test camel-git add
name|template
operator|.
name|sendBodyAndHeader
argument_list|(
literal|"direct:add"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_FILE_NAME
argument_list|,
name|filenameToAdd
argument_list|)
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|removeTest ()
specifier|public
name|void
name|removeTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
comment|// Test camel-git remove
name|template
operator|.
name|sendBodyAndHeader
argument_list|(
literal|"direct:remove"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_FILE_NAME
argument_list|,
name|filenameToAdd
argument_list|)
expr_stmt|;
comment|// Check
name|gitDir
operator|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
expr_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|status
operator|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
expr_stmt|;
name|assertFalse
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|commitTest ()
specifier|public
name|void
name|commitTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
comment|// Test camel-git commit
name|template
operator|.
name|sendBodyAndHeader
argument_list|(
literal|"direct:commit"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
comment|// Check
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|commitTestEmpty ()
specifier|public
name|void
name|commitTestEmpty
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git commit (with no changes)
name|template
operator|.
name|requestBodyAndHeader
argument_list|(
literal|"direct:commit"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
comment|// Check that it has been commited twice
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
argument_list|(
name|expected
operator|=
name|CamelExecutionException
operator|.
name|class
argument_list|)
DECL|method|commitTestAllowEmptyFalse ()
specifier|public
name|void
name|commitTestAllowEmptyFalse
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git commit (with allowEmpty set to false)
name|Map
argument_list|<
name|String
argument_list|,
name|Object
argument_list|>
name|headers
init|=
operator|new
name|HashMap
argument_list|<>
argument_list|()
decl_stmt|;
name|headers
operator|.
name|put
argument_list|(
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|template
operator|.
name|requestBodyAndHeaders
argument_list|(
literal|"direct:commit-not-allow-empty"
argument_list|,
literal|""
argument_list|,
name|headers
argument_list|)
expr_stmt|;
comment|// Check : An exception should have been raised
block|}
annotation|@
name|Test
DECL|method|addAndStatusAndCommitTest ()
specifier|public
name|void
name|addAndStatusAndCommitTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Initialize repository using JGit
name|Repository
name|repository
init|=
name|getTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Git
name|git
init|=
operator|new
name|Git
argument_list|(
name|repository
argument_list|)
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
comment|// Checking camel route
name|Map
argument_list|<
name|String
argument_list|,
name|Object
argument_list|>
name|headers
init|=
operator|new
name|HashMap
argument_list|<>
argument_list|()
decl_stmt|;
name|headers
operator|.
name|put
argument_list|(
name|GitConstants
operator|.
name|GIT_FILE_NAME
argument_list|,
name|filenameToAdd
argument_list|)
expr_stmt|;
name|headers
operator|.
name|put
argument_list|(
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|template
operator|.
name|requestBodyAndHeaders
argument_list|(
literal|"direct:add-status-commit"
argument_list|,
literal|""
argument_list|,
name|headers
argument_list|)
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|commitBranchTest ()
specifier|public
name|void
name|commitBranchTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|checkout
argument_list|()
operator|.
name|setCreateBranch
argument_list|(
literal|true
argument_list|)
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|setUpstreamMode
argument_list|(
name|SetupUpstreamMode
operator|.
name|SET_UPSTREAM
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git commit (with branch)
name|template
operator|.
name|send
argument_list|(
literal|"direct:commit-branch"
argument_list|,
operator|new
name|Processor
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|process
parameter_list|(
name|Exchange
name|exchange
parameter_list|)
throws|throws
name|Exception
block|{
name|exchange
operator|.
name|getIn
argument_list|()
operator|.
name|setHeader
argument_list|(
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessageBranch
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessageBranch
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|commitAllTest ()
specifier|public
name|void
name|commitAllTest
parameter_list|()
throws|throws
name|Exception
block|{
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|template
operator|.
name|send
argument_list|(
literal|"direct:commit-all"
argument_list|,
operator|new
name|Processor
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|process
parameter_list|(
name|Exchange
name|exchange
parameter_list|)
throws|throws
name|Exception
block|{
name|exchange
operator|.
name|getIn
argument_list|()
operator|.
name|setHeader
argument_list|(
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessageAll
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessageAll
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|commitAllDifferentBranchTest ()
specifier|public
name|void
name|commitAllDifferentBranchTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|checkout
argument_list|()
operator|.
name|setCreateBranch
argument_list|(
literal|true
argument_list|)
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|setUpstreamMode
argument_list|(
name|SetupUpstreamMode
operator|.
name|SET_UPSTREAM
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|fileToAdd1
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameBranchToAdd
argument_list|)
decl_stmt|;
name|fileToAdd1
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
comment|// Test camel-git add and commit (different branches)
name|template
operator|.
name|send
argument_list|(
literal|"direct:add-on-branch"
argument_list|,
operator|new
name|Processor
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|process
parameter_list|(
name|Exchange
name|exchange
parameter_list|)
throws|throws
name|Exception
block|{
name|exchange
operator|.
name|getIn
argument_list|()
operator|.
name|setHeader
argument_list|(
name|GitConstants
operator|.
name|GIT_FILE_NAME
argument_list|,
name|filenameBranchToAdd
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|template
operator|.
name|send
argument_list|(
literal|"direct:commit-all-branch"
argument_list|,
operator|new
name|Processor
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|process
parameter_list|(
name|Exchange
name|exchange
parameter_list|)
throws|throws
name|Exception
block|{
name|exchange
operator|.
name|getIn
argument_list|()
operator|.
name|setHeader
argument_list|(
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessageAll
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
comment|// Check
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessageAll
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|removeFileBranchTest ()
specifier|public
name|void
name|removeFileBranchTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|checkout
argument_list|()
operator|.
name|setCreateBranch
argument_list|(
literal|true
argument_list|)
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|setUpstreamMode
argument_list|(
name|SetupUpstreamMode
operator|.
name|SET_UPSTREAM
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|fileToAdd1
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameBranchToAdd
argument_list|)
decl_stmt|;
name|fileToAdd1
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameBranchToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessageAll
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessageAll
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
comment|// Test camel-git remove
name|template
operator|.
name|send
argument_list|(
literal|"direct:remove-on-branch"
argument_list|,
operator|new
name|Processor
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|process
parameter_list|(
name|Exchange
name|exchange
parameter_list|)
throws|throws
name|Exception
block|{
name|exchange
operator|.
name|getIn
argument_list|()
operator|.
name|setHeader
argument_list|(
name|GitConstants
operator|.
name|GIT_FILE_NAME
argument_list|,
name|filenameToAdd
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
comment|// Check
name|git
operator|.
name|checkout
argument_list|()
operator|.
name|setCreateBranch
argument_list|(
literal|false
argument_list|)
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|status
operator|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
expr_stmt|;
name|assertFalse
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|createBranchTest ()
specifier|public
name|void
name|createBranchTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git create-branch
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:create-branch"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
comment|// Check
name|List
argument_list|<
name|Ref
argument_list|>
name|ref
init|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|boolean
name|branchCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/heads/"
operator|+
name|branchTest
argument_list|)
condition|)
block|{
name|branchCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|branchCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|deleteBranchTest ()
specifier|public
name|void
name|deleteBranchTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|branchCreate
argument_list|()
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|List
argument_list|<
name|Ref
argument_list|>
name|ref
init|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|boolean
name|branchCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/heads/"
operator|+
name|branchTest
argument_list|)
condition|)
block|{
name|branchCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|branchCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
comment|// Test camel-git delete-branch
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:delete-branch"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|ref
operator|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
expr_stmt|;
name|branchCreated
operator|=
literal|false
expr_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/heads/"
operator|+
name|branchTest
argument_list|)
condition|)
block|{
name|branchCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|branchCreated
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|statusTest ()
specifier|public
name|void
name|statusTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
comment|// Test camel-git status
name|Status
name|status
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:status"
argument_list|,
literal|""
argument_list|,
name|Status
operator|.
name|class
argument_list|)
decl_stmt|;
comment|// Check
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|Status
name|gitStatus
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertEquals
argument_list|(
name|gitStatus
operator|.
name|getAdded
argument_list|()
argument_list|,
name|status
operator|.
name|getAdded
argument_list|()
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|statusBranchTest ()
specifier|public
name|void
name|statusBranchTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|branchCreate
argument_list|()
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|List
argument_list|<
name|Ref
argument_list|>
name|ref
init|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|boolean
name|branchCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/heads/"
operator|+
name|branchTest
argument_list|)
condition|)
block|{
name|branchCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|branchCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAddDifferent
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameBranchToAdd
argument_list|)
decl_stmt|;
name|fileToAddDifferent
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameBranchToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git status branch
name|status
operator|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:status-branch"
argument_list|,
literal|""
argument_list|,
name|Status
operator|.
name|class
argument_list|)
expr_stmt|;
comment|// Check
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameBranchToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|Status
name|gitStatus
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertEquals
argument_list|(
name|gitStatus
operator|.
name|getAdded
argument_list|()
argument_list|,
name|status
operator|.
name|getAdded
argument_list|()
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|logTest ()
specifier|public
name|void
name|logTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git log
name|Iterable
argument_list|<
name|RevCommit
argument_list|>
name|revCommits
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:log"
argument_list|,
literal|""
argument_list|,
name|Iterable
operator|.
name|class
argument_list|)
decl_stmt|;
comment|// Check
name|Iterator
argument_list|<
name|RevCommit
argument_list|>
name|gitLogs
init|=
name|git
operator|.
name|log
argument_list|()
operator|.
name|call
argument_list|()
operator|.
name|iterator
argument_list|()
decl_stmt|;
for|for
control|(
name|RevCommit
name|rev
range|:
name|revCommits
control|)
block|{
name|RevCommit
name|gitRevCommit
init|=
name|gitLogs
operator|.
name|next
argument_list|()
decl_stmt|;
name|assertEquals
argument_list|(
name|gitRevCommit
operator|.
name|getName
argument_list|()
argument_list|,
name|rev
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|logBranchTest ()
specifier|public
name|void
name|logBranchTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|branchCreate
argument_list|()
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|List
argument_list|<
name|Ref
argument_list|>
name|ref
init|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|boolean
name|branchCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/heads/"
operator|+
name|branchTest
argument_list|)
condition|)
block|{
name|branchCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|branchCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAddDifferent
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameBranchToAdd
argument_list|)
decl_stmt|;
name|fileToAddDifferent
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameBranchToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessageAll
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git log (with branches)
name|Iterable
argument_list|<
name|RevCommit
argument_list|>
name|revCommits
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:log-branch"
argument_list|,
literal|""
argument_list|,
name|Iterable
operator|.
name|class
argument_list|)
decl_stmt|;
comment|// Check
name|Iterator
argument_list|<
name|RevCommit
argument_list|>
name|gitLogs
init|=
name|git
operator|.
name|log
argument_list|()
operator|.
name|call
argument_list|()
operator|.
name|iterator
argument_list|()
decl_stmt|;
for|for
control|(
name|RevCommit
name|rev
range|:
name|revCommits
control|)
block|{
name|RevCommit
name|gitRevCommit
init|=
name|gitLogs
operator|.
name|next
argument_list|()
decl_stmt|;
name|assertEquals
argument_list|(
name|gitRevCommit
operator|.
name|getName
argument_list|()
argument_list|,
name|rev
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
name|assertEquals
argument_list|(
name|gitRevCommit
operator|.
name|getShortMessage
argument_list|()
argument_list|,
name|rev
operator|.
name|getShortMessage
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|createTagTest ()
specifier|public
name|void
name|createTagTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git create tag
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:create-tag"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
comment|// Check
name|List
argument_list|<
name|Ref
argument_list|>
name|ref
init|=
name|git
operator|.
name|tagList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|boolean
name|tagCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/tags/"
operator|+
name|tagTest
argument_list|)
condition|)
block|{
name|tagCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|tagCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|deleteTagTest ()
specifier|public
name|void
name|deleteTagTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|tag
argument_list|()
operator|.
name|setName
argument_list|(
name|tagTest
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|List
argument_list|<
name|Ref
argument_list|>
name|ref
init|=
name|git
operator|.
name|tagList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|boolean
name|tagCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/tags/"
operator|+
name|tagTest
argument_list|)
condition|)
block|{
name|tagCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|tagCreated
argument_list|,
literal|true
argument_list|)
expr_stmt|;
comment|// Test camel-git delete-tag
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:delete-tag"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
comment|// Check
name|ref
operator|=
name|git
operator|.
name|tagList
argument_list|()
operator|.
name|call
argument_list|()
expr_stmt|;
name|boolean
name|tagExists
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|ref
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/tags/"
operator|+
name|tagTest
argument_list|)
condition|)
block|{
name|tagExists
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
name|tagExists
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|showBranchesTest ()
specifier|public
name|void
name|showBranchesTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|branchCreate
argument_list|()
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git show-branches
name|List
argument_list|<
name|Ref
argument_list|>
name|branches
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:show-branches"
argument_list|,
literal|""
argument_list|,
name|List
operator|.
name|class
argument_list|)
decl_stmt|;
comment|// Check
name|Boolean
name|branchExists
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|reference
range|:
name|branches
control|)
block|{
if|if
condition|(
operator|(
literal|"refs/heads/"
operator|+
name|branchTest
operator|)
operator|.
name|equals
argument_list|(
name|reference
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
name|branchExists
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertTrue
argument_list|(
name|branchExists
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|cherryPickTest ()
specifier|public
name|void
name|cherryPickTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|branchCreate
argument_list|()
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|List
argument_list|<
name|Ref
argument_list|>
name|branches
init|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|Boolean
name|branchExists
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|reference
range|:
name|branches
control|)
block|{
if|if
condition|(
operator|(
literal|"refs/heads/"
operator|+
name|branchTest
operator|)
operator|.
name|equals
argument_list|(
name|reference
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
name|branchExists
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertTrue
argument_list|(
name|branchExists
argument_list|)
expr_stmt|;
name|String
name|fileToAdd1Name
init|=
literal|"filetest1test.txt"
decl_stmt|;
name|File
name|fileToAdd1
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|fileToAdd1Name
argument_list|)
decl_stmt|;
name|fileToAdd1
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|fileToAdd1Name
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|status
operator|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
expr_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|fileToAdd1Name
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
literal|"Test second commit"
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Iterable
argument_list|<
name|RevCommit
argument_list|>
name|logs
init|=
name|git
operator|.
name|log
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
literal|"Test second commit"
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|String
name|id
init|=
name|logs
operator|.
name|iterator
argument_list|()
operator|.
name|next
argument_list|()
operator|.
name|getName
argument_list|()
decl_stmt|;
comment|// Test camel-git cherry-pick
name|template
operator|.
name|sendBodyAndHeader
argument_list|(
literal|"direct:cherrypick"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_COMMIT_ID
argument_list|,
name|id
argument_list|)
expr_stmt|;
comment|// Check
name|validateGitLogs
argument_list|(
name|git
argument_list|,
literal|"Test second commit"
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|cherryPickBranchToMasterTest ()
specifier|public
name|void
name|cherryPickBranchToMasterTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|git
operator|.
name|branchCreate
argument_list|()
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|List
argument_list|<
name|Ref
argument_list|>
name|branches
init|=
name|git
operator|.
name|branchList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|Boolean
name|branchExists
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|reference
range|:
name|branches
control|)
block|{
if|if
condition|(
operator|(
literal|"refs/heads/"
operator|+
name|branchTest
operator|)
operator|.
name|equals
argument_list|(
name|reference
operator|.
name|getName
argument_list|()
argument_list|)
condition|)
block|{
name|branchExists
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertTrue
argument_list|(
name|branchExists
argument_list|)
expr_stmt|;
name|String
name|fileToAdd1Name
init|=
literal|"filetest1test.txt"
decl_stmt|;
name|File
name|fileToAdd1
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|fileToAdd1Name
argument_list|)
decl_stmt|;
name|fileToAdd1
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|fileToAdd1Name
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|status
operator|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
expr_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|fileToAdd1Name
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
literal|"Test second commit"
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Iterable
argument_list|<
name|RevCommit
argument_list|>
name|logs
init|=
name|git
operator|.
name|log
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
literal|"Test second commit"
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|String
name|id
init|=
name|logs
operator|.
name|iterator
argument_list|()
operator|.
name|next
argument_list|()
operator|.
name|getName
argument_list|()
decl_stmt|;
comment|// Test camel-git cherry-pick (on master)
name|template
operator|.
name|sendBodyAndHeader
argument_list|(
literal|"direct:cherrypick-master"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_COMMIT_ID
argument_list|,
name|id
argument_list|)
expr_stmt|;
comment|// Check
name|git
operator|.
name|checkout
argument_list|()
operator|.
name|setCreateBranch
argument_list|(
literal|false
argument_list|)
operator|.
name|setName
argument_list|(
literal|"refs/heads/master"
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
literal|"Test second commit"
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|remoteAddTest ()
specifier|public
name|void
name|remoteAddTest
parameter_list|()
throws|throws
name|Exception
block|{
name|Repository
name|repository
init|=
name|getTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Git
name|git
init|=
operator|new
name|Git
argument_list|(
name|repository
argument_list|)
decl_stmt|;
name|List
argument_list|<
name|RemoteConfig
argument_list|>
name|remoteConfigList
init|=
name|git
operator|.
name|remoteList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|remoteConfigList
operator|.
name|size
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
name|Object
name|result
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:remoteAdd"
argument_list|,
literal|""
argument_list|)
decl_stmt|;
name|assertTrue
argument_list|(
name|result
operator|instanceof
name|RemoteConfig
argument_list|)
expr_stmt|;
name|RemoteConfig
name|remoteConfig
init|=
operator|(
name|RemoteConfig
operator|)
name|result
decl_stmt|;
name|remoteConfigList
operator|=
name|git
operator|.
name|remoteList
argument_list|()
operator|.
name|call
argument_list|()
expr_stmt|;
name|assertTrue
argument_list|(
name|remoteConfigList
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|assertEquals
argument_list|(
name|remoteConfigList
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getName
argument_list|()
argument_list|,
name|remoteConfig
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
name|assertEquals
argument_list|(
name|remoteConfigList
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getURIs
argument_list|()
argument_list|,
name|remoteConfig
operator|.
name|getURIs
argument_list|()
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|remoteListTest ()
specifier|public
name|void
name|remoteListTest
parameter_list|()
throws|throws
name|Exception
block|{
name|Repository
name|repository
init|=
name|getTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Git
name|git
init|=
operator|new
name|Git
argument_list|(
name|repository
argument_list|)
decl_stmt|;
name|RemoteAddCommand
name|remoteAddCommand
init|=
name|git
operator|.
name|remoteAdd
argument_list|()
decl_stmt|;
name|remoteAddCommand
operator|.
name|setName
argument_list|(
literal|"origin"
argument_list|)
expr_stmt|;
name|remoteAddCommand
operator|.
name|setUri
argument_list|(
operator|new
name|URIish
argument_list|(
name|remoteUriTest
argument_list|)
argument_list|)
expr_stmt|;
name|remoteAddCommand
operator|.
name|call
argument_list|()
expr_stmt|;
name|List
argument_list|<
name|RemoteConfig
argument_list|>
name|gitRemoteConfigs
init|=
name|git
operator|.
name|remoteList
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|Object
name|result
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:remoteList"
argument_list|,
literal|""
argument_list|)
decl_stmt|;
name|assertTrue
argument_list|(
name|result
operator|instanceof
name|List
argument_list|)
expr_stmt|;
name|List
argument_list|<
name|RemoteConfig
argument_list|>
name|remoteConfigs
init|=
operator|(
name|List
argument_list|<
name|RemoteConfig
argument_list|>
operator|)
name|result
decl_stmt|;
name|assertEquals
argument_list|(
name|gitRemoteConfigs
operator|.
name|size
argument_list|()
argument_list|,
name|remoteConfigs
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|assertEquals
argument_list|(
name|gitRemoteConfigs
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getName
argument_list|()
argument_list|,
name|remoteConfigs
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
name|assertEquals
argument_list|(
name|gitRemoteConfigs
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getURIs
argument_list|()
argument_list|,
name|remoteConfigs
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getURIs
argument_list|()
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|cleanTest ()
specifier|public
name|void
name|cleanTest
parameter_list|()
throws|throws
name|Exception
block|{
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
comment|// Test camel-git add
name|Set
argument_list|<
name|String
argument_list|>
name|cleaned
init|=
name|template
operator|.
name|requestBodyAndHeader
argument_list|(
literal|"direct:clean"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_FILE_NAME
argument_list|,
name|filenameToAdd
argument_list|,
name|Set
operator|.
name|class
argument_list|)
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|assertTrue
argument_list|(
name|cleaned
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|gcTest ()
specifier|public
name|void
name|gcTest
parameter_list|()
throws|throws
name|Exception
block|{
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git commit (with no changes)
name|template
operator|.
name|requestBodyAndHeader
argument_list|(
literal|"direct:commit"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
comment|// Check that it has been commited twice
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
comment|// Test camel-git add
name|Properties
name|gcResult
init|=
name|template
operator|.
name|requestBodyAndHeader
argument_list|(
literal|"direct:gc"
argument_list|,
literal|""
argument_list|,
name|GitConstants
operator|.
name|GIT_FILE_NAME
argument_list|,
name|filenameToAdd
argument_list|,
name|Properties
operator|.
name|class
argument_list|)
decl_stmt|;
name|assertNotNull
argument_list|(
name|gcResult
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|mergeTest ()
specifier|public
name|void
name|mergeTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
name|git
operator|.
name|checkout
argument_list|()
operator|.
name|setCreateBranch
argument_list|(
literal|true
argument_list|)
operator|.
name|setName
argument_list|(
name|branchTest
argument_list|)
operator|.
name|setUpstreamMode
argument_list|(
name|SetupUpstreamMode
operator|.
name|SET_UPSTREAM
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git commit (with branch)
name|template
operator|.
name|send
argument_list|(
literal|"direct:commit-branch"
argument_list|,
operator|new
name|Processor
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|process
parameter_list|(
name|Exchange
name|exchange
parameter_list|)
throws|throws
name|Exception
block|{
name|exchange
operator|.
name|getIn
argument_list|()
operator|.
name|setHeader
argument_list|(
name|GitConstants
operator|.
name|GIT_COMMIT_MESSAGE
argument_list|,
name|commitMessageBranch
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|validateGitLogs
argument_list|(
name|git
argument_list|,
name|commitMessageBranch
argument_list|,
name|commitMessage
argument_list|)
expr_stmt|;
comment|// Test camel-git commit (with branch)
name|MergeResult
name|result
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:merge"
argument_list|,
literal|""
argument_list|,
name|MergeResult
operator|.
name|class
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|result
operator|.
name|getMergeStatus
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|,
literal|"Fast-forward"
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|showTagsTest ()
specifier|public
name|void
name|showTagsTest
parameter_list|()
throws|throws
name|Exception
block|{
comment|// Init
name|Git
name|git
init|=
name|getGitTestRepository
argument_list|()
decl_stmt|;
name|File
name|fileToAdd
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
name|filenameToAdd
argument_list|)
decl_stmt|;
name|fileToAdd
operator|.
name|createNewFile
argument_list|()
expr_stmt|;
name|git
operator|.
name|add
argument_list|()
operator|.
name|addFilepattern
argument_list|(
name|filenameToAdd
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
name|File
name|gitDir
init|=
operator|new
name|File
argument_list|(
name|gitLocalRepo
argument_list|,
literal|".git"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|gitDir
operator|.
name|exists
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|Status
name|status
init|=
name|git
operator|.
name|status
argument_list|()
operator|.
name|call
argument_list|()
decl_stmt|;
name|assertTrue
argument_list|(
name|status
operator|.
name|getAdded
argument_list|()
operator|.
name|contains
argument_list|(
name|filenameToAdd
argument_list|)
argument_list|)
expr_stmt|;
name|git
operator|.
name|commit
argument_list|()
operator|.
name|setMessage
argument_list|(
name|commitMessage
argument_list|)
operator|.
name|call
argument_list|()
expr_stmt|;
comment|// Test camel-git create tag
name|template
operator|.
name|sendBody
argument_list|(
literal|"direct:create-tag"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
comment|// Check
name|List
argument_list|<
name|Ref
argument_list|>
name|result
init|=
name|template
operator|.
name|requestBody
argument_list|(
literal|"direct:show-tags"
argument_list|,
literal|""
argument_list|,
name|List
operator|.
name|class
argument_list|)
decl_stmt|;
name|boolean
name|tagCreated
init|=
literal|false
decl_stmt|;
for|for
control|(
name|Ref
name|refInternal
range|:
name|result
control|)
block|{
if|if
condition|(
name|refInternal
operator|.
name|getName
argument_list|()
operator|.
name|equals
argument_list|(
literal|"refs/tags/"
operator|+
name|tagTest
argument_list|)
condition|)
block|{
name|tagCreated
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|assertEquals
argument_list|(
literal|true
argument_list|,
name|tagCreated
argument_list|)
expr_stmt|;
name|git
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|createRouteBuilder ()
specifier|protected
name|RouteBuilder
name|createRouteBuilder
parameter_list|()
throws|throws
name|Exception
block|{
return|return
operator|new
name|RouteBuilder
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|configure
parameter_list|()
throws|throws
name|Exception
block|{
name|from
argument_list|(
literal|"direct:clone"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?remotePath=https://github.com/oscerd/json-webserver-example.git&operation=clone"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:init"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=init"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:add"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=add"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:checkout"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=checkout&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:checkout-specific-tag"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=checkout&branchName="
operator|+
name|branchTest
operator|+
literal|"&tagName="
operator|+
name|tagTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:remove"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=remove"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:add-on-branch"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=add&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:remove-on-branch"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=add&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:commit"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=commit"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:commit-not-allow-empty"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=commit&allowEmpty=false"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:commit-branch"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=commit&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:commit-all"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=commit"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:commit-all-branch"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=commit&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:add-status-commit"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=add"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=status"
argument_list|)
operator|.
name|choice
argument_list|()
operator|.
name|when
argument_list|(
name|simple
argument_list|(
literal|"${body.hasUncommittedChanges()}"
argument_list|)
argument_list|)
operator|.
name|log
argument_list|(
literal|"Commiting changes..."
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=commit"
argument_list|)
operator|.
name|otherwise
argument_list|()
operator|.
name|log
argument_list|(
literal|"Nothing to commit"
argument_list|)
operator|.
name|end
argument_list|()
expr_stmt|;
name|from
argument_list|(
literal|"direct:create-branch"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=createBranch&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:delete-branch"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=deleteBranch&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:status"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=status"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:status-branch"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=status&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:log"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=log"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:log-branch"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=log&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:create-tag"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=createTag&tagName="
operator|+
name|tagTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:delete-tag"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=deleteTag&tagName="
operator|+
name|tagTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:show-branches"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=showBranches"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:cherrypick"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=cherryPick&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:cherrypick-master"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=cherryPick&branchName=refs/heads/master"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:pull"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?remoteName=origin&operation=pull"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:clean"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=clean"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:gc"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=gc"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:remoteAdd"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=remoteAdd&remotePath=https://github.com/oscerd/json-webserver-example.git&remoteName=origin"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:remoteList"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=remoteList"
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:merge"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=merge&branchName="
operator|+
name|branchTest
argument_list|)
expr_stmt|;
name|from
argument_list|(
literal|"direct:show-tags"
argument_list|)
operator|.
name|to
argument_list|(
literal|"git://"
operator|+
name|gitLocalRepo
operator|+
literal|"?operation=showTags"
argument_list|)
expr_stmt|;
block|}
block|}
return|;
block|}
block|}
end_class

end_unit

