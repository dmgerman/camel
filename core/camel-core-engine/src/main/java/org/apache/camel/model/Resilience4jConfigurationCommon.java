begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * Licensed to the Apache Software Foundation (ASF) under one or more  * contributor license agreements.  See the NOTICE file distributed with  * this work for additional information regarding copyright ownership.  * The ASF licenses this file to You under the Apache License, Version 2.0  * (the "License"); you may not use this file except in compliance with  * the License.  You may obtain a copy of the License at  *  *      http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  * See the License for the specific language governing permissions and  * limitations under the License.  */
end_comment

begin_package
DECL|package|org.apache.camel.model
package|package
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|model
package|;
end_package

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|concurrent
operator|.
name|ForkJoinPool
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|bind
operator|.
name|annotation
operator|.
name|XmlAccessType
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|bind
operator|.
name|annotation
operator|.
name|XmlAccessorType
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|bind
operator|.
name|annotation
operator|.
name|XmlAttribute
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|camel
operator|.
name|spi
operator|.
name|Metadata
import|;
end_import

begin_class
annotation|@
name|XmlAccessorType
argument_list|(
name|XmlAccessType
operator|.
name|FIELD
argument_list|)
DECL|class|Resilience4jConfigurationCommon
specifier|public
class|class
name|Resilience4jConfigurationCommon
extends|extends
name|IdentifiedType
block|{
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|)
DECL|field|circuitBreakerRef
specifier|private
name|String
name|circuitBreakerRef
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|)
DECL|field|configRef
specifier|private
name|String
name|configRef
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"50"
argument_list|)
DECL|field|failureRateThreshold
specifier|private
name|Float
name|failureRateThreshold
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"10"
argument_list|)
DECL|field|permittedNumberOfCallsInHalfOpenState
specifier|private
name|Integer
name|permittedNumberOfCallsInHalfOpenState
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"100"
argument_list|)
DECL|field|slidingWindowSize
specifier|private
name|Integer
name|slidingWindowSize
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"COUNT_BASED"
argument_list|,
name|enums
operator|=
literal|"TIME_BASED,COUNT_BASED"
argument_list|)
DECL|field|slidingWindowType
specifier|private
name|String
name|slidingWindowType
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"100"
argument_list|)
DECL|field|minimumNumberOfCalls
specifier|private
name|Integer
name|minimumNumberOfCalls
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"true"
argument_list|)
DECL|field|writableStackTraceEnabled
specifier|private
name|Boolean
name|writableStackTraceEnabled
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"60"
argument_list|)
DECL|field|waitDurationInOpenState
specifier|private
name|Integer
name|waitDurationInOpenState
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"false"
argument_list|)
DECL|field|automaticTransitionFromOpenToHalfOpenEnabled
specifier|private
name|Boolean
name|automaticTransitionFromOpenToHalfOpenEnabled
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"100"
argument_list|)
DECL|field|slowCallRateThreshold
specifier|private
name|Float
name|slowCallRateThreshold
decl_stmt|;
annotation|@
name|XmlAttribute
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"circuitbreaker"
argument_list|,
name|defaultValue
operator|=
literal|"60"
argument_list|)
DECL|field|slowCallDurationThreshold
specifier|private
name|Integer
name|slowCallDurationThreshold
decl_stmt|;
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"bulkhead"
argument_list|,
name|defaultValue
operator|=
literal|"false"
argument_list|)
DECL|field|bulkheadEnabled
specifier|private
name|Boolean
name|bulkheadEnabled
decl_stmt|;
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"bulkhead"
argument_list|,
name|defaultValue
operator|=
literal|"25"
argument_list|)
DECL|field|bulkheadMaxConcurrentCalls
specifier|private
name|Integer
name|bulkheadMaxConcurrentCalls
decl_stmt|;
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"bulkhead"
argument_list|,
name|defaultValue
operator|=
literal|"0"
argument_list|)
DECL|field|bulkheadMaxWaitDuration
specifier|private
name|Integer
name|bulkheadMaxWaitDuration
decl_stmt|;
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"timeout"
argument_list|,
name|defaultValue
operator|=
literal|"false"
argument_list|)
DECL|field|timeoutEnabled
specifier|private
name|Boolean
name|timeoutEnabled
decl_stmt|;
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"timeout"
argument_list|)
DECL|field|timeoutExecutorServiceRef
specifier|private
name|String
name|timeoutExecutorServiceRef
decl_stmt|;
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"timeout"
argument_list|,
name|defaultValue
operator|=
literal|"1000"
argument_list|)
DECL|field|timeoutDuration
specifier|private
name|Integer
name|timeoutDuration
decl_stmt|;
annotation|@
name|Metadata
argument_list|(
name|label
operator|=
literal|"timeout"
argument_list|,
name|defaultValue
operator|=
literal|"true"
argument_list|)
DECL|field|timeoutCancelRunningFuture
specifier|private
name|Boolean
name|timeoutCancelRunningFuture
decl_stmt|;
comment|// Getter/Setter
comment|// -------------------------------------------------------------------------
DECL|method|getCircuitBreakerRef ()
specifier|public
name|String
name|getCircuitBreakerRef
parameter_list|()
block|{
return|return
name|circuitBreakerRef
return|;
block|}
comment|/**      * Refers to an existing io.github.resilience4j.circuitbreaker.CircuitBreaker instance      * to lookup and use from the registry. When using this, then any other circuit breaker options      * are not in use.      */
DECL|method|setCircuitBreakerRef (String circuitBreakerRef)
specifier|public
name|void
name|setCircuitBreakerRef
parameter_list|(
name|String
name|circuitBreakerRef
parameter_list|)
block|{
name|this
operator|.
name|circuitBreakerRef
operator|=
name|circuitBreakerRef
expr_stmt|;
block|}
DECL|method|getConfigRef ()
specifier|public
name|String
name|getConfigRef
parameter_list|()
block|{
return|return
name|configRef
return|;
block|}
comment|/**      * Refers to an existing io.github.resilience4j.circuitbreaker.CircuitBreakerConfig instance      * to lookup and use from the registry.      */
DECL|method|setConfigRef (String configRef)
specifier|public
name|void
name|setConfigRef
parameter_list|(
name|String
name|configRef
parameter_list|)
block|{
name|this
operator|.
name|configRef
operator|=
name|configRef
expr_stmt|;
block|}
DECL|method|getFailureRateThreshold ()
specifier|public
name|Float
name|getFailureRateThreshold
parameter_list|()
block|{
return|return
name|failureRateThreshold
return|;
block|}
comment|/**      * Configures the failure rate threshold in percentage.      * If the failure rate is equal or greater than the threshold the CircuitBreaker transitions to open and starts short-circuiting calls.      *<p>      * The threshold must be greater than 0 and not greater than 100. Default value is 50 percentage.      */
DECL|method|setFailureRateThreshold (Float failureRateThreshold)
specifier|public
name|void
name|setFailureRateThreshold
parameter_list|(
name|Float
name|failureRateThreshold
parameter_list|)
block|{
name|this
operator|.
name|failureRateThreshold
operator|=
name|failureRateThreshold
expr_stmt|;
block|}
DECL|method|getPermittedNumberOfCallsInHalfOpenState ()
specifier|public
name|Integer
name|getPermittedNumberOfCallsInHalfOpenState
parameter_list|()
block|{
return|return
name|permittedNumberOfCallsInHalfOpenState
return|;
block|}
comment|/**      * Configures the number of permitted calls when the CircuitBreaker is half open.      *<p>      * The size must be greater than 0. Default size is 10.      */
DECL|method|setPermittedNumberOfCallsInHalfOpenState (Integer permittedNumberOfCallsInHalfOpenState)
specifier|public
name|void
name|setPermittedNumberOfCallsInHalfOpenState
parameter_list|(
name|Integer
name|permittedNumberOfCallsInHalfOpenState
parameter_list|)
block|{
name|this
operator|.
name|permittedNumberOfCallsInHalfOpenState
operator|=
name|permittedNumberOfCallsInHalfOpenState
expr_stmt|;
block|}
DECL|method|getSlidingWindowSize ()
specifier|public
name|Integer
name|getSlidingWindowSize
parameter_list|()
block|{
return|return
name|slidingWindowSize
return|;
block|}
comment|/**      * Configures the size of the sliding window which is used to record the outcome of calls when the CircuitBreaker is closed.      * {@code slidingWindowSize} configures the size of the sliding window. Sliding window can either be count-based or time-based.      *      * If {@code slidingWindowType} is COUNT_BASED, the last {@code slidingWindowSize} calls are recorded and aggregated.      * If {@code slidingWindowType} is TIME_BASED, the calls of the last {@code slidingWindowSize} seconds are recorded and aggregated.      *<p>      * The {@code slidingWindowSize} must be greater than 0.      * The {@code minimumNumberOfCalls} must be greater than 0.      * If the slidingWindowType is COUNT_BASED, the {@code minimumNumberOfCalls} cannot be greater than {@code slidingWindowSize}.      * If the slidingWindowType is TIME_BASED, you can pick whatever you want.      *      * Default slidingWindowSize is 100.      */
DECL|method|setSlidingWindowSize (Integer slidingWindowSize)
specifier|public
name|void
name|setSlidingWindowSize
parameter_list|(
name|Integer
name|slidingWindowSize
parameter_list|)
block|{
name|this
operator|.
name|slidingWindowSize
operator|=
name|slidingWindowSize
expr_stmt|;
block|}
DECL|method|getSlidingWindowType ()
specifier|public
name|String
name|getSlidingWindowType
parameter_list|()
block|{
return|return
name|slidingWindowType
return|;
block|}
comment|/**      * Configures the type of the sliding window which is used to record the outcome of calls when the CircuitBreaker is closed.      * Sliding window can either be count-based or time-based.      *      * If {@code slidingWindowType} is COUNT_BASED, the last {@code slidingWindowSize} calls are recorded and aggregated.      * If {@code slidingWindowType} is TIME_BASED, the calls of the last {@code slidingWindowSize} seconds are recorded and aggregated.      *      * Default slidingWindowType is COUNT_BASED.      */
DECL|method|setSlidingWindowType (String slidingWindowType)
specifier|public
name|void
name|setSlidingWindowType
parameter_list|(
name|String
name|slidingWindowType
parameter_list|)
block|{
name|this
operator|.
name|slidingWindowType
operator|=
name|slidingWindowType
expr_stmt|;
block|}
DECL|method|getMinimumNumberOfCalls ()
specifier|public
name|Integer
name|getMinimumNumberOfCalls
parameter_list|()
block|{
return|return
name|minimumNumberOfCalls
return|;
block|}
comment|/**      * Configures configures the minimum number of calls which are required (per sliding window period) before the CircuitBreaker can calculate the error rate.      * For example, if {@code minimumNumberOfCalls} is 10, then at least 10 calls must be recorded, before the failure rate can be calculated.      * If only 9 calls have been recorded the CircuitBreaker will not transition to open even if all 9 calls have failed.      *      * Default minimumNumberOfCalls is 100      */
DECL|method|setMinimumNumberOfCalls (Integer minimumNumberOfCalls)
specifier|public
name|void
name|setMinimumNumberOfCalls
parameter_list|(
name|Integer
name|minimumNumberOfCalls
parameter_list|)
block|{
name|this
operator|.
name|minimumNumberOfCalls
operator|=
name|minimumNumberOfCalls
expr_stmt|;
block|}
DECL|method|getWritableStackTraceEnabled ()
specifier|public
name|Boolean
name|getWritableStackTraceEnabled
parameter_list|()
block|{
return|return
name|writableStackTraceEnabled
return|;
block|}
comment|/**      * Enables writable stack traces. When set to false, Exception.getStackTrace returns a zero length array.      * This may be used to reduce log spam when the circuit breaker is open as the cause of the exceptions is already known (the circuit breaker is short-circuiting calls).      */
DECL|method|setWritableStackTraceEnabled (Boolean writableStackTraceEnabled)
specifier|public
name|void
name|setWritableStackTraceEnabled
parameter_list|(
name|Boolean
name|writableStackTraceEnabled
parameter_list|)
block|{
name|this
operator|.
name|writableStackTraceEnabled
operator|=
name|writableStackTraceEnabled
expr_stmt|;
block|}
DECL|method|getWaitDurationInOpenState ()
specifier|public
name|Integer
name|getWaitDurationInOpenState
parameter_list|()
block|{
return|return
name|waitDurationInOpenState
return|;
block|}
comment|/**      * Configures the wait duration (in seconds) which specifies how long the CircuitBreaker should stay open, before it switches to half open.      * Default value is 60 seconds.      */
DECL|method|setWaitDurationInOpenState (Integer waitDurationInOpenState)
specifier|public
name|void
name|setWaitDurationInOpenState
parameter_list|(
name|Integer
name|waitDurationInOpenState
parameter_list|)
block|{
name|this
operator|.
name|waitDurationInOpenState
operator|=
name|waitDurationInOpenState
expr_stmt|;
block|}
DECL|method|getAutomaticTransitionFromOpenToHalfOpenEnabled ()
specifier|public
name|Boolean
name|getAutomaticTransitionFromOpenToHalfOpenEnabled
parameter_list|()
block|{
return|return
name|automaticTransitionFromOpenToHalfOpenEnabled
return|;
block|}
comment|/**      * Enables automatic transition from OPEN to HALF_OPEN state once the waitDurationInOpenState has passed.      */
DECL|method|setAutomaticTransitionFromOpenToHalfOpenEnabled (Boolean automaticTransitionFromOpenToHalfOpenEnabled)
specifier|public
name|void
name|setAutomaticTransitionFromOpenToHalfOpenEnabled
parameter_list|(
name|Boolean
name|automaticTransitionFromOpenToHalfOpenEnabled
parameter_list|)
block|{
name|this
operator|.
name|automaticTransitionFromOpenToHalfOpenEnabled
operator|=
name|automaticTransitionFromOpenToHalfOpenEnabled
expr_stmt|;
block|}
DECL|method|getSlowCallRateThreshold ()
specifier|public
name|Float
name|getSlowCallRateThreshold
parameter_list|()
block|{
return|return
name|slowCallRateThreshold
return|;
block|}
comment|/**      * Configures a threshold in percentage. The CircuitBreaker considers a call as slow when the call duration is greater than slowCallDurationThreshold(Duration.      * When the percentage of slow calls is equal or greater the threshold, the CircuitBreaker transitions to open and starts short-circuiting calls.      *<p>      * The threshold must be greater than 0 and not greater than 100.      * Default value is 100 percentage which means that all recorded calls must be slower than slowCallDurationThreshold.      */
DECL|method|setSlowCallRateThreshold (Float slowCallRateThreshold)
specifier|public
name|void
name|setSlowCallRateThreshold
parameter_list|(
name|Float
name|slowCallRateThreshold
parameter_list|)
block|{
name|this
operator|.
name|slowCallRateThreshold
operator|=
name|slowCallRateThreshold
expr_stmt|;
block|}
DECL|method|getSlowCallDurationThreshold ()
specifier|public
name|Integer
name|getSlowCallDurationThreshold
parameter_list|()
block|{
return|return
name|slowCallDurationThreshold
return|;
block|}
comment|/**      * Configures the duration threshold (seconds) above which calls are considered as slow and increase the slow calls percentage.      * Default value is 60 seconds.      */
DECL|method|setSlowCallDurationThreshold (Integer slowCallDurationThreshold)
specifier|public
name|void
name|setSlowCallDurationThreshold
parameter_list|(
name|Integer
name|slowCallDurationThreshold
parameter_list|)
block|{
name|this
operator|.
name|slowCallDurationThreshold
operator|=
name|slowCallDurationThreshold
expr_stmt|;
block|}
DECL|method|getBulkheadEnabled ()
specifier|public
name|Boolean
name|getBulkheadEnabled
parameter_list|()
block|{
return|return
name|bulkheadEnabled
return|;
block|}
comment|/**      * Whether bulkhead is enabled or not on the circuit breaker.      * Default is false.      */
DECL|method|setBulkheadEnabled (Boolean bulkheadEnabled)
specifier|public
name|void
name|setBulkheadEnabled
parameter_list|(
name|Boolean
name|bulkheadEnabled
parameter_list|)
block|{
name|this
operator|.
name|bulkheadEnabled
operator|=
name|bulkheadEnabled
expr_stmt|;
block|}
DECL|method|getBulkheadMaxConcurrentCalls ()
specifier|public
name|Integer
name|getBulkheadMaxConcurrentCalls
parameter_list|()
block|{
return|return
name|bulkheadMaxConcurrentCalls
return|;
block|}
comment|/**      * Configures the max amount of concurrent calls the bulkhead will support.      */
DECL|method|setBulkheadMaxConcurrentCalls (Integer bulkheadMaxConcurrentCalls)
specifier|public
name|void
name|setBulkheadMaxConcurrentCalls
parameter_list|(
name|Integer
name|bulkheadMaxConcurrentCalls
parameter_list|)
block|{
name|this
operator|.
name|bulkheadMaxConcurrentCalls
operator|=
name|bulkheadMaxConcurrentCalls
expr_stmt|;
block|}
DECL|method|getBulkheadMaxWaitDuration ()
specifier|public
name|Integer
name|getBulkheadMaxWaitDuration
parameter_list|()
block|{
return|return
name|bulkheadMaxWaitDuration
return|;
block|}
comment|/**      * Configures a maximum amount of time which the calling thread will wait to enter the bulkhead. If bulkhead has space available, entry      * is guaranteed and immediate. If bulkhead is full, calling threads will contest for space, if it becomes available. maxWaitDuration can be set to 0.      *<p>      * Note: for threads running on an event-loop or equivalent (rx computation pool, etc), setting maxWaitDuration to 0 is highly recommended. Blocking      * an event-loop thread will most likely have a negative effect on application throughput.      */
DECL|method|setBulkheadMaxWaitDuration (Integer bulkheadMaxWaitDuration)
specifier|public
name|void
name|setBulkheadMaxWaitDuration
parameter_list|(
name|Integer
name|bulkheadMaxWaitDuration
parameter_list|)
block|{
name|this
operator|.
name|bulkheadMaxWaitDuration
operator|=
name|bulkheadMaxWaitDuration
expr_stmt|;
block|}
DECL|method|getTimeoutEnabled ()
specifier|public
name|Boolean
name|getTimeoutEnabled
parameter_list|()
block|{
return|return
name|timeoutEnabled
return|;
block|}
comment|/**      * Whether timeout is enabled or not on the circuit breaker.      * Default is false.      */
DECL|method|setTimeoutEnabled (Boolean timeoutEnabled)
specifier|public
name|void
name|setTimeoutEnabled
parameter_list|(
name|Boolean
name|timeoutEnabled
parameter_list|)
block|{
name|this
operator|.
name|timeoutEnabled
operator|=
name|timeoutEnabled
expr_stmt|;
block|}
DECL|method|getTimeoutExecutorServiceRef ()
specifier|public
name|String
name|getTimeoutExecutorServiceRef
parameter_list|()
block|{
return|return
name|timeoutExecutorServiceRef
return|;
block|}
comment|/**      * References to a custom thread pool to use when timeout is enabled (uses {@link ForkJoinPool#commonPool()} by default)      */
DECL|method|setTimeoutExecutorServiceRef (String timeoutExecutorServiceRef)
specifier|public
name|void
name|setTimeoutExecutorServiceRef
parameter_list|(
name|String
name|timeoutExecutorServiceRef
parameter_list|)
block|{
name|this
operator|.
name|timeoutExecutorServiceRef
operator|=
name|timeoutExecutorServiceRef
expr_stmt|;
block|}
DECL|method|getTimeoutDuration ()
specifier|public
name|Integer
name|getTimeoutDuration
parameter_list|()
block|{
return|return
name|timeoutDuration
return|;
block|}
comment|/**      * Configures the thread execution timeout.      * Default value is 1 second.      */
DECL|method|setTimeoutDuration (Integer timeoutDuration)
specifier|public
name|void
name|setTimeoutDuration
parameter_list|(
name|Integer
name|timeoutDuration
parameter_list|)
block|{
name|this
operator|.
name|timeoutDuration
operator|=
name|timeoutDuration
expr_stmt|;
block|}
DECL|method|getTimeoutCancelRunningFuture ()
specifier|public
name|Boolean
name|getTimeoutCancelRunningFuture
parameter_list|()
block|{
return|return
name|timeoutCancelRunningFuture
return|;
block|}
comment|/**      * Configures whether cancel is called on the running future.      * Defaults to true.      */
DECL|method|setTimeoutCancelRunningFuture (Boolean timeoutCancelRunningFuture)
specifier|public
name|void
name|setTimeoutCancelRunningFuture
parameter_list|(
name|Boolean
name|timeoutCancelRunningFuture
parameter_list|)
block|{
name|this
operator|.
name|timeoutCancelRunningFuture
operator|=
name|timeoutCancelRunningFuture
expr_stmt|;
block|}
block|}
end_class

end_unit

